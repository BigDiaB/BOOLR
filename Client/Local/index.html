<meta charset="utf-8">

<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="../popup.css">

<title>PWS // SANDBOX MODE</title>
<!-- Het belangrijkste deel van de hele pagina. Dit is een HTML5-element die uitgestrekt is over de hele pagina waarmee met JavaScript op getekent kan worden. -->
<!-- Ik heb hier het attribuut 'tabindex' met waarde '1' aangegeven als snelle oplossing om met JavaScript te checken of het canvas element 'focus' heeft. -->
<canvas id="canvas" tabindex="1"></canvas>

<!-- De console die verschijnt als je op de toets 't' drukt. -->
<div id="console">
    <!-- Button om de console te verbergen -->
    <button id="close" onclick="this.parentNode.hide()" class="material-icons">close</button>

    <div id="input" contenteditable="true" spellcheck="false"></div>
    <div id="messages"></div>
</div>

<ul id="notifications"></ul>

<!-- Component toolbar -->
<div id="toolbar">
    <div class="slot">I/O</div>
    <div class="slot" onmousedown="select(NOT)">!</div>
    <div class="slot" onmousedown="select(AND)">&</div>
    <div class="slot" onmousedown="select(OR)">|</div>
    <div class="slot" onmousedown="select(XOR)">^</div>
    <div class="slot" onmousedown="popup.custom_component.show()">+</div>
    <div class="slot" onmousedown="popup.component_list.show()">...</div>

    <div id="toast"></div>

    <ul id="list" tabindex="1" style="display: none">
        <li onclick="select(Input)">Input</li>
        <li onclick="select(Output)">Output</li>
        <li onclick="select(Constant)">Constant</li>
        <li onclick="select(Delay)">Delay</li>
        <li onclick="select(Clock)">Clock</li>
        <li onclick="select(D2B)">D2B Converter</li>
        <li onclick="select(B2D)">B2D Converter</li>
        <li>LED</li>
    </ul>
</div>

<!-- Credits -->
<div id="credits">
    <span id="version" onclick="popup.whatsnew.show()">PWS v0.1.58</span>
    <button onclick="popup.settings.show()" class="material-icons">settings</button>
    <button onclick="popup.info.show()" class="material-icons">help</button>
</div>

<!-- Debug info -->
<div id="debugInfo"></div>

<!-- Component info -->
<div id="componentInfo"></div>

<!-- Context menu -->
<ul id="contextMenu" tabindex="1" oncontextmenu="return false" style="display: none;"></ul>

<!-- Loading screen -->
<div id="loading">Loading...</div>

<!-- Overlay -->
<div id="overlay"></div>

<!-- Pop-ups -->
<div class="popup" id="confirm">
    <h1></h1>
    <p></p>
    <button class="ok">OK</button>
    <button class="cancel">Cancel</button>
</div>

<div class="popup" id="prompt">
    <h1>Prompt</h1>
    <p>Text</p>
    <input spellcheck="false">
    <button class="ok">OK</button>
    <button class="cancel">Cancel</button>
</div>

<div class="popup" id="whatsnew">
    <h1></h1>
    <ul>
        <li><span style="font-family: Edwardian Script ITC; font-size: 30px">Verbeterd design</span></li>
        <li><i class="material-icons">lightbulb_outline</i>(tips)</li>
        <li>Draden trekken verbeterd</li>
        <li>Input/Output labels</li>
        <li>Een paar nieuwe fancy animatietjes</li>
    </ul>
    <p style="color: darkred">Let op! Als je dit programma via GitHub gedownload hebt, werkt het nog niet om via het hoofdmenu projecten vanaf bestanden te openen. Je kunt wel een bestand openen via 'Sandbox mode' > Ctrl + O</p>
    <br>
    <button class="ok">Close</button>
</div>

<div class="popup" id="custom_component">
    <h1>Create custom component</h1>
    <textarea spellcheck="false">
class Component {
    constructor() {

    }
}
    </textarea>
    <br>
    <button class="ok" disabled="true">OK</button>
    <button class="cancel">Cancel</button>
</div>

<div class="popup" id="component_list">
    <h1>Component list</h1>
    <p style="font-family: 'Roboto'; font-size: 20px; opacity: .5">Not yet available</p>
    <button class="ok">Close</button>
</div>

<div class="popup" id="settings">
    <h1>Settings</h1>
    <ul>
        <li>Scroll animation<label class="switch"><input type="checkbox" setting="scroll_animation"><div class="slider"></div></label></li>
        <li>Zoom animation<label class="switch"><input type="checkbox" setting="zoom_animation"><div class="slider"></div></label></li>
        <li>Update delay<label><input type="number" value="0" setting="update_delay"></label></li>
        <li><button onclick="popup.confirm.show('Clear localStorage','Are you sure you want to clear all local stored data?', () => { localStorage.pws = ''; location.reload() })">Clear localStorage</button></li>
    </ul>
    <button class="ok">OK</button>
    <button class="cancel">Cancel</button>
</div>

<div class="popup" id="info">
    <h1>Info</h1>
    <button class="ok">Close</button>
</div>

<div class="popup" id="login">
    <h1>Login</h1>
    <input id="username" placeholder="Username">
    <br><br>
    <input id="password" placeholder="Password" type="password">
    <button class="ok">Login</button>
    <button class="cancel">Cancel</button>
</div>

<div class="popup" id="color_picker">
    <h1>Color picker</h1>
    <input type="color">
    <br>
    <button class="ok">OK</button>
    <button class="cancel">Cancel</button>
</div>

<div class="popup" id="connections">
    <h1>Connections</h1>
    <div></div>
    <button class="ok">Close</button>
</div>

<!-- Tips -->
<div class="tip" id="dragging">
    <i class="material-icons">lightbulb_outline</i>
    Press the right mouse button to cancel dragging
</div>
<div class="tip" id="connecting">
    <i class="material-icons">lightbulb_outline</i>
    Hold the shift key to draw the wire in a straight line
</div>

<!-- Open files -->
<input id="open_file" type="file" accept=".dat" style="display: none">

<!-- Chrome -->
<div id="usechrome">
    <a href="https://www.google.nl/chrome/browser/desktop/"><img src="http://logok.org/wp-content/uploads/2014/12/Chrome-logo-2015.png"></a>
    <h1>Please use Chrome to run this application</h1>
</div>

<script>
    document.getElementById("open_file").onchange = function(e) {
        const input = e.target;

        const reader = new FileReader;
        reader.onload = function() {
            components = [];
            parse(reader.result);
        }
        reader.readAsText(input.files[0]);
    }
</script>

<!-- Scrippies -->
<script>
    if(!window.chrome) { document.getElementById("usechrome").style.display = "block"; window.stop(); }
</script>
<script src="main.js"></script>
<script src="ticker.js"></script>
<script src="actions.js"></script>
<script src="clipbord.js"></script>
<script src="keys.js"></script>
<script src="console.js"></script>
<script src="notifications.js"></script>
<script src="toolbar.js"></script>
<script src="components.js"></script>
<script src="misc.js"></script>
<script src="debug.js"></script>
<script src="contextmenu.js"></script>
<script src="componentInfo.js"></script>
<script src="tips.js"></script>
<script src="../popup.js"></script>
<!--script src="stringifier.js"></script-->
<script src="localStorage.js"></script>
<script src="websocket.js"></script>
<script>
    "use strict";

    const VERSION = "0.1.121";
    document.getElementById("version").innerHTML = "PWS v" + VERSION;

    let data;
    if(localStorage.pws) data = JSON.parse(localStorage.pws);
    else data = {};

    if(data.version != VERSION) {
        popup.whatsnew.show()
    }
    if(data.clipbord) parse(data.clipbord,true);
    if(data.settings) settings = data.settings;

    c.focus();

    updateDebugInfo();
    setInterval(updateDebugInfo, 500);

    draw();  // 'draw' loop starten
    //tick(); // 'tick' loop starten
</script>
